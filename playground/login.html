 <!doctype html>
<html class="pixel-ratio-1">
<head>
<meta charset="utf-8">
<title>登录 - 水木书荟</title>
<script src="https://code.jquery.com/jquery-3.2.1.js"
  integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
  crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30="
crossorigin="anonymous"></script>
<link href="https://cdn.bootcss.com/light7/0.4.3/css/light7-swipeout.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/light7/0.4.3/css/light7-swiper.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/light7/0.4.3/css/light7.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/light7/0.4.3/js/light7-swipeout.js"></script>
<script src="https://cdn.bootcss.com/light7/0.4.3/js/light7-swiper.js"></script>
<script src="https://cdn.bootcss.com/light7/0.4.3/js/light7.js"></script>
<script src="assets\js\jquery.sha256.js"></script>
<script src="assets\js\jquery.cookie.js"></script>
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<link rel="shortcut icon" href="//static.hdslb.com/images/favicon.ico">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script>
        var serverurl = "q.aureliano.cc:4567";
        function Login()
        {
        	
             password = $("#password_input").val();
             mail = $("#email_input").val();
             $.ajax(
             	{type:'POST',
             	xhrFields: 
             	{
      		    withCredentials: true
 	    	},
             	url: serverurl+"/users/auth",
             	data:{"authinfo":
			 {
			    "mail":mail,
		                 "hashedPassword":$.sha256(mail,password,"Lino")
		             }
		         },
                         success:function (data, status)
                          {
                       	       $.ajax(
                       	       {
                       	       type:"GET",
                       	       xhrFields: 
             	       {
      		    	withCredentials: true
 	    	       },
 	    	       datatype:"json",
                       	       url:	serverurl+"/users/me",
                       	       success:function(data,status)
    		       {
    			//alert(data.user.uid);
            			localStorage.uid = data.user.uid;
            			localStorage.mail=mail;
    		       }}
    		       );
                              window.location.href="index.html";
                          }
                      }
             );
			//alert(username+" "+password);

        }
        </script>

</head>

<body class="tabbar-hidden">
<div class="page no-tabbar">
	<header class="bar bar-nav">
	  <h1 class="title">登录</h1>
	</header>
	<div class="content">
	  <div class="list-block">
		<ul>
		  <!-- Text inputs -->
		  <li>
			<div class="item-content">
			  <div class="item-media"><i class="icon icon-form-name"></i></div>
			  <div class="item-inner">
				<div class="item-title label">邮箱地址</div>
				<div class="item-input">
				  <input id="email_input"type="text" placeholder="Email">
				</div>
			  </div>
			</div>
		  </li>
		  <li>
			<div class="item-content">
			  <div class="item-media"><i class="icon icon-form-password"></i></div>
			  <div class="item-inner">
				<div class="item-title label">密码</div>
				<div class="item-input">
				  <input id="password_input" type="password" placeholder="Password" class="">
				</div>
			  </div>
			</div>
		  </li>
		</ul>
	  </div>
	  <div class="content-block">
		<div class="row">
		  <div class="col-50"><a href="index.html#page-home" class="button button-big button-fill button-danger back">返回</a></div>
		  <div class="col-50"><a href="#" class="button button-big button-fill button-success" onclick="Login()" >登录</a></div>
		</div>
	  </div>
	</div>
</div>

</body>
</html>
